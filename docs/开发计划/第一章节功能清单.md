# 《构造层》第一章节完整开发需求清单

基于小说第1-4章内容整理

## ✅ 已完成的功能

### 1. 基础系统
- [x] Desktop桌面系统
- [x] Taskbar任务栏（带固定应用快捷方式）
- [x] WindowManager窗口管理
- [x] FileSystem文件系统（支持隐藏文件）
- [x] SaveManager存档系统
- [x] AudioManager音效系统
- [x] BootScreen开机画面

### 2. 欢迎页面
- [x] IntroSequence引子动画
- [x] MainMenu主菜单
- [x] SaveLoadPage存档选择
- [x] ChapterSelectPage章节选择
- [x] AchievementsPage成就系统
- [x] SettingsPage系统设置

### 3. 应用程序
- [x] FileExplorer文件资源管理器
- [x] Notepad记事本
- [x] PDFReader PDF阅读器（带图层切换）
- [x] WeChatApp微信（完整聊天记录）
- [x] ChromeApp浏览器（历史记录+166次异常访问）

### 4. 剧情系统
- [x] DialogBox对话系统
- [x] NarrativeTriggerSystem剧情触发
- [x] SystemNotification系统通知
- [x] 第一个触发点：archive文件夹显示

### 5. 游戏数据
- [x] Chapter1Files 完整文件数据
  - [x] 工作文件（需求文档PDF、设计稿、报价表）
  - [x] 生活杂物（追剧清单、游戏截图、外卖收藏、读书笔记）
  - [x] archive隐藏文件夹
  - [x] 失踪案例PDF（带隐藏图层）
- [x] wechatMessages 微信聊天数据
- [x] browserHistory 浏览器历史记录

---

## ❌ 还需要实现的关键功能

### 优先级1：VS Code应用 ⭐⭐⭐⭐⭐
**为什么重要：** 小说第三章的核心内容，玩家必须通过VS Code发现sequence.txt

**需要实现：**
- [ ] VS Code界面（深色主题）
- [ ] 文件树（左侧，可折叠）
- [ ] "最近打开"功能
- [ ] 文本编辑器区域
- [ ] 显示以下文件：
  - sequence.txt（访问序列，8步仪式）
  - draft_8.txt（关于第8步的猜想）
  - CORE_README.txt（系统说明）
  - 关于网络失踪案例的初步整理.pdf

**相关小说段落：**
> "那是钥匙。你打开了VS Code。"
> "你点击顶部菜单栏的'文件' → '打开最近'。"

**数据需求：**
```typescript
// 需要在Chapter1Files中添加
{
  id: 'folder_system',
  name: '.system',
  type: 'folder',
  isHidden: true,
  children: ['file_sequence', 'file_draft8', 'file_core_readme', 'file_observer']
}
```

---

### 优先级2：CORE系统实时显示 ⭐⭐⭐⭐⭐
**为什么重要：** 游戏的核心Meta恐怖元素，百分比实时跳动制造紧张感

**需要实现：**
- [ ] 实时百分比计数器（动态增长）
- [ ] 显示在CORE_README.txt文件底部
- [ ] 根据玩家行为动态计算：
  - 打开文件 +2%
  - 阅读超过30秒 +3%
  - 查看微信 +5%
  - 查看浏览器历史 +8%
  - 发现archive +12%
- [ ] 预计达成时间计算
- [ ] 视觉效果（数字滚动动画）

**相关小说段落：**
> "你的数字人格模型完整度：34%"
> "在你探索虚拟机的这段时间里，又增加了24%。"

**实现建议：**
在GameStore中添加：
```typescript
interface GameStore {
  coreProgress: number; // 0-100
  updateCoreProgress: (delta: number) => void;
  calculateETA: () => string;
}
```

---

### 优先级3：observer.exe进程显示 ⭐⭐⭐⭐
**为什么重要：** 强化"被观察"的恐怖感

**需要实现：**
- [ ] TaskManager任务管理器应用
- [ ] 显示observer.exe进程：
  - PID: 8964
  - 内存: 3.2 MB
  - CPU: 0.1% → 1.2%（动态变化）
  - 状态: 正在运行
- [ ] 右键菜单："结束任务"
- [ ] 弹窗提示："无法结束该进程。原因：权限不足。"

**相关小说段落：**
> "它确实在运行。从你开机的那一刻起，它就一直在后台运行。悄无声息。"
> "你尝试右键点击'结束任务'。系统弹出提示：无法结束该进程。"

---

### 优先级4：VirtualBox虚拟机系统 ⭐⭐⭐⭐⭐
**为什么重要：** 第三章的高潮，玩家发现镜像自我

**需要实现：**
- [ ] VirtualBox应用
- [ ] Mirror.vbox虚拟机启动
- [ ] 嵌套桌面显示（递归Desktop组件）
- [ ] 虚拟机内的文件与外层系统同步
- [ ] 虚拟机内的PDF多第9个案例（苏澜）
- [ ] 文件同步演示（question.txt）

**相关小说段落：**
> "你双击了它。VirtualBox管理器启动，显示一个虚拟机：Mirror"
> "你在外层系统和虚拟机之间切换。两边的桌面开始同步。"

**技术难点：**
- 需要实现Desktop组件的递归渲染
- 文件系统需要支持层级上下文
- 状态同步机制

---

### 优先级5：对话系统（与副本对话）⭐⭐⭐⭐⭐
**为什么重要：** 第四章的核心，揭示真相的关键

**需要实现：**
- [ ] IM聊天界面
- [ ] 玩家输入框
- [ ] 副本自动回复
- [ ] 预设对话树：
  - "你是谁？"
  - "你能证明吗？"
  - "那8个人都是我？"
  - "我接下来该怎么办？"
- [ ] 打字动画效果
- [ ] 系统提示："连接中...正在同步意识模型..."

**相关小说段落：**
> "屏幕闪烁了一下。两个系统的界面同时消失，变成纯黑色。"
> "然后，中央出现一个对话框，像是某种即时通讯软件的界面"

---

### 优先级6：memory_fragments文件夹 ⭐⭐⭐⭐
**为什么重要：** 揭示身份循环的证据

**需要实现：**
- [ ] memory_fragments文件夹
- [ ] 47个子文件夹（每个代表一个身份）
- [ ] 每个文件夹内有identity_log.txt：
  - 身份记录编号
  - 名称
  - 创建时间
  - 触发方式
  - 角色设定
  - 结局/状态
- [ ] 特殊文件夹：
  - 2017-05-23_夜航船
  - 2018-03-17_浅蓝色
  - 2020-11-03_echo_404
  - 2024-05-18_苏澜
  - 2024-11-03_[玩家姓名]

**相关小说段落：**
> "里面有数十个子文件夹，每个都以日期命名"
> "最后一个文件夹的名字，是你的真实姓名。"

---

### 优先级7：三个结局选择 ⭐⭐⭐⭐⭐
**为什么重要：** 游戏的最终分支

**需要实现：**
- [ ] 选择界面UI
- [ ] 三个选项：
  1. **关机（遗忘）**
     - 淡出黑屏
     - 显示："几个月后，你可能会再次收到快递..."
     - 回到主菜单
  2. **等待100%（共存）**
     - 百分比继续增长动画
     - 到达100%时显示成就"共存"
     - 副本完整生成
  3. **执行序列（进入构造层）**
     - 等待到凌晨3:17
     - 执行sequence.txt的8步
     - 屏幕闪烁效果
     - 进入第二章预告

**相关小说段落：**
> "三个选择，和CORE说的一样。"
> "你做出了决定。"

---

## 🎨 需要的额外文件数据

### .system文件夹内容
```typescript
// src/data/SystemFiles.ts
export const systemFiles: VirtualFile[] = [
  {
    id: 'file_sequence',
    name: 'sequence.txt',
    content: `# 访问序列记录
步骤1：在凌晨3:17打开浏览器 ✓
步骤2：搜索关键词"forgotten forum" ✓
...
步骤8：[此处内容已删除]
步骤9：???`
  },
  {
    id: 'file_draft8',
    name: 'draft_8.txt',
    content: `# 第8步是什么？
在完成前7步后，404页面会变成一个纯黑的页面...`
  },
  {
    id: 'file_core_readme',
    name: 'CORE_README.txt',
    content: `# CORE系统说明文档
欢迎。如果你能看到这个文件，说明你已经意识到了某些不对劲的地方。
...
当前进度：
你的数字人格模型完整度：{dynamic}%`
  },
  {
    id: 'file_observer',
    name: 'observer.exe',
    fileType: 'app',
    metadata: {
      size: 3276800,
      created: new Date('2021-03-15T14:22:00'),
      modified: new Date('2024-05-18T03:17:00'),
      description: 'Consciousness Observation and Recursive Evaluation System',
      version: '0.8.7'
    }
  }
];
```

---

## 🔄 剧情触发时间线

1. **14:37** - 开机，进入桌面
2. **探索阶段** - 浏览文件、微信、Chrome
3. **第一触发** - 发现archive文件夹（viewed_wechat + viewed_browser_history）
4. **17:00左右** - 发现.system文件夹，打开VS Code
5. **18:00左右** - 发现VirtualBox，启动虚拟机
6. **19:00左右** - 与副本对话
7. **23:14** - CORE达到87%（如果继续探索）
8. **凌晨3:17** - 可选择执行序列

---

## 🚀 建议的开发顺序

1. **本次会话剩余时间：**
   - 完善Notepad集成
   - 创建VS Code应用（简化版）
   - 添加.system文件夹数据

2. **下次会话：**
   - 实现CORE百分比系统
   - 实现TaskManager
   - 添加observer.exe进程

3. **第三次会话：**
   - 实现VirtualBox虚拟机
   - 文件同步系统
   - memory_fragments文件夹

4. **第四次会话：**
   - 对话系统
   - 三个结局
   - 完整测试流程

---

当前最紧急的任务是：**VS Code应用**，因为它是承上启下的关键节点。
