# Construct Layer - 构造层

一个基于网页的互动式 ARG（Alternate Reality Game）游戏，改编自科幻悬疑小说《构造层》。

## 项目简介

《构造层》是一款沉浸式的叙事解谜游戏，玩家将扮演一个普通人，在日常使用电脑的过程中逐渐发现自己所处世界的真相。游戏通过高度还原的 Windows 10 系统界面，让玩家在"正常使用电脑"的过程中，通过探索文件、浏览网页、查看聊天记录等方式，拼凑出隐藏的故事线索。

### 核心特色

- **高度还原的 Windows 10 界面** - 完整模拟桌面、任务栏、文件管理器等系统组件
- **沉浸式叙事体验** - 通过文件、聊天记录、浏览器历史等碎片化信息展开故事
- **动态剧情触发系统** - 基于玩家行为的智能剧情推进机制
- **多结局设计** - 玩家的选择将影响最终走向
- **CORE 系统** - 实时追踪玩家行为，构建"数字人格模型"

## 技术栈

- **React 18.3.1** - 现代化的前端框架
- **TypeScript** - 类型安全的开发体验
- **Zustand** - 轻量级状态管理
- **Framer Motion** - 流畅的动画效果
- **Tailwind CSS** - 快速的样式开发
- **Vite** - 极速的构建工具
- **IndexedDB** - 本地存档系统

## 游戏内容

### 已实现功能

#### 系统应用
- 🗂️ **文件管理器** - 浏览和管理虚拟文件系统
- 📝 **记事本** - 查看 .txt 文件
- 🌐 **Chrome 浏览器** - 模拟的网页浏览，包含多个 ARG 网站
- 💬 **微信** - 查看对话记录和朋友圈
- 💻 **VS Code** - 查看代码和系统文件
- 📄 **PDF 阅读器** - 查看关键文档
- 📊 **Office 套件** - 查看 Word/Excel 文档
- 🖼️ **图片查看器** - 查看图片文件

#### 游戏机制
- ✅ 欢迎页面（主菜单、章节选择、存档管理、设置）
- ✅ 开机引导动画
- ✅ 虚拟文件系统（支持隐藏文件）
- ✅ 剧情触发系统
- ✅ CORE 百分比追踪系统
- ✅ 系统通知
- ✅ 存档/读档系统（IndexedDB）

### 开发中功能

- 🔲 任务管理器（observer.exe 进程）
- 🔲 VirtualBox 虚拟机系统
- 🔲 与数字副本的对话系统
- 🔲 memory_fragments（47 个身份记录）
- 🔲 三个结局分支

## 快速开始

### 环境要求

- Node.js 18+
- pnpm（推荐）或 npm

### 安装依赖

```bash
pnpm install
# 或
npm install
```

### 开发模式

```bash
pnpm dev
# 或
npm run dev
```

访问 http://localhost:3000 即可开始游戏。

### 构建生产版本

```bash
pnpm build
# 或
npm run build
```

构建产物将输出到 `dist` 目录。

## 项目结构

```
src/
├── components/          # React 组件
│   ├── apps/           # 应用程序组件（微信、浏览器等）
│   ├── os/             # 操作系统组件（桌面、任务栏等）
│   ├── narrative/      # 叙事系统组件
│   └── welcome/        # 欢迎页面组件
├── data/               # 游戏数据
│   └── Chapter1Files.ts # 第一章文件数据
├── hooks/              # 自定义 React Hooks
├── stores/             # Zustand 状态管理
│   ├── useFileSystem.ts    # 文件系统
│   ├── useGameStore.ts     # 游戏状态
│   └── useWindowStore.ts   # 窗口管理
├── utils/              # 工具函数
└── pages/              # 页面组件
    └── Welcome/        # 欢迎页面
```

## 游戏机制说明

### 文件系统

游戏使用虚拟文件系统，支持：
- 文件夹嵌套
- 隐藏文件（isHidden 属性）
- 多种文件类型（.txt, .pdf, .docx, .xlsx, .png 等）
- 动态文件显示（基于剧情进度）

### 剧情触发系统

通过 `NarrativeTriggerSystem` 组件实现：
- 监控玩家行为设置 flags
- 当满足特定 flags 组合时触发事件
- 事件可以：显示系统通知、解锁隐藏文件、推进剧情等

### CORE 系统

CORE（Comprehensive Observer & Reality Evaluation）系统会追踪：
- 玩家打开的文件数量
- 触发的关键剧情点
- 探索进度
- 随时间缓慢增长

百分比达到 100% 时将触发特殊剧情。

## 存档系统

游戏支持多存档：
- 自动保存（每次重要操作后）
- 手动存档（存档管理页面）
- 存档包含：游戏进度、flags、文件状态、窗口状态等
- 使用 IndexedDB 存储，支持浏览器本地持久化

## 开发路线图

### 第一章（开发中）
- [x] 基础系统框架
- [x] 核心应用实现
- [x] 剧情触发系统
- [x] CORE 追踪系统
- [ ] 任务管理器
- [ ] VirtualBox 虚拟机
- [ ] 对话系统
- [ ] 第一章完整剧情

### 后续章节
- [ ] 第二章内容
- [ ] 第三章内容
- [ ] 第四章内容
- [ ] 终章与多结局

## 贡献指南

欢迎提交 Issue 和 Pull Request！

### 开发建议

1. 使用 TypeScript 严格模式
2. 遵循 React Hooks 最佳实践
3. 组件应当保持单一职责
4. 提交前确保代码格式化
5. 重要功能需要添加注释

## 许可证

MIT License

## 致谢

- 原作小说：《构造层》
- UI 设计灵感：Windows 10
- 技术支持：React 社区

---

**注意：** 本项目仅供学习交流使用，游戏内容为虚构，请勿过度沉迷。
